const appState={currentSection:'home',loanAmount:2e3,sliderAutoPlay:null,testimonialAutoPlay:null,sections:{}};const domElements={header:document.getElementById('header'),mainNav:document.getElementById('main-nav'),mobileMenuBtn:document.getElementById('mobile-menu-btn'),mainContent:document.getElementById('main-content'),dynamicContent:document.getElementById('dynamic-content'),logo:document.getElementById('logo'),heroSlider:document.getElementById('hero-slider'),sliderTrack:document.getElementById('slider-track'),sliderDots:document.getElementById('slider-dots'),prevSlideBtn:document.getElementById('prev-slide'),nextSlideBtn:document.getElementById('next-slide'),donationSlider:document.getElementById('donation-slider'),donationInput:document.getElementById('donation-input'),sliderValue:document.getElementById('slider-value'),loanAccess:document.getElementById('loan-access'),communityImpact:document.getElementById('community-impact'),calculateBtn:document.getElementById('calculate-btn'),testimonialSlider:document.getElementById('testimonial-slider'),prevTestimonialBtn:document.getElementById('prev-testimonial'),nextTestimonialBtn:document.getElementById('next-testimonial'),navLinks:document.querySelectorAll('.nav-link'),dropdowns:document.querySelectorAll('.dropdown')};function initApp(){console.log('Microokoa Guaranty Capital Website Initializing...');initPWA();initNavigation();initHeroSlider();initLoanCalculator();initTestimonialSlider();initDynamicContent();initEventListeners();updateLoanCalculator();console.log('Website initialized successfully.')}
function initNavigation(){console.log('Initializing navigation system...');domElements.mobileMenuBtn.addEventListener('click',toggleMobileMenu);domElements.navLinks.forEach((e=>{e.addEventListener('click',(function(t){t.preventDefault();const n=this.getAttribute('data-section');console.log(`Navigating to section: ${n}`);domElements.navLinks.forEach((e=>e.classList.remove('active')));this.classList.add('active');closeMobileMenu();loadSection(n);const o=this.closest('.dropdown');o&&o.classList.remove('active')}))}));domElements.dropdowns.forEach((e=>{const t=e.querySelector('.nav-link');t.addEventListener('click',(function(e){window.innerWidth<=992&&(e.preventDefault(),e.stopPropagation(),this.closest('.dropdown').classList.toggle('active'))}))}));document.addEventListener('click',(function(e){domElements.dropdowns.forEach((t=>{e.target.closest('.dropdown')||t.classList.remove('active')}))}))}
function toggleMobileMenu(){domElements.mainNav.classList.toggle('active');const e=domElements.mobileMenuBtn.querySelector('i');domElements.mainNav.classList.contains('active')?(e.classList.remove('fa-bars'),e.classList.add('fa-times')):(e.classList.remove('fa-times'),e.classList.add('fa-bars'))}
function closeMobileMenu(){domElements.mainNav.classList.remove('active');const e=domElements.mobileMenuBtn.querySelector('i');e.classList.remove('fa-times'),e.classList.add('fa-bars')}
function initHeroSlider(){console.log('Initializing hero slider...');const e=document.querySelectorAll('.slide'),t=document.querySelectorAll('.dot');let n=0,o=e.length;function i(e){e>=o?n=0:e<0&&(n=o-1);domElements.sliderTrack.style.transform=`translateX(-${100*n}%)`;e.forEach(((e,t)=>e.classList.toggle('active',t===n)));t.forEach(((e,t)=>e.classList.toggle('active',t===n)))}
function c(){n--,i(n),r()}function l(){n++,i(n),r()}domElements.prevSlideBtn.addEventListener('click',c);domElements.nextSlideBtn.addEventListener('click',l);t.forEach(((e,t)=>{e.addEventListener('click',(()=>{n=t,i(n),r()}))}));function s(){appState.sliderAutoPlay=setInterval((()=>{n++,i(n)}),5e3)}function r(){clearInterval(appState.sliderAutoPlay),s()}s();domElements.heroSlider.addEventListener('mouseenter',(()=>{clearInterval(appState.sliderAutoPlay)}));domElements.heroSlider.addEventListener('mouseleave',s);console.log(`Hero slider initialized with ${o} slides`)}
function initLoanCalculator(){console.log('Initializing loan calculator...');domElements.donationSlider.addEventListener('input',(function(){const e=parseInt(this.value);domElements.donationInput.value=e,domElements.sliderValue.textContent=formatCurrency(e),updateLoanCalculator()}));domElements.donationInput.addEventListener('input',(function(){let e=parseInt(this.value)||200;e=Math.min(Math.max(e,200),5e4),this.value=e,domElements.donationSlider.value=e,domElements.sliderValue.textContent=formatCurrency(e),updateLoanCalculator()}));domElements.calculateBtn.addEventListener('click',(()=>{calculateLoan(),animateCalculatorResults()}));updateLoanCalculator()}
function updateLoanCalculator(){const e=parseInt(domElements.donationInput.value)||200,t=10*e,n=Math.floor(e/200);domElements.loanAccess.textContent=formatCurrency(t)+' KSH',domElements.communityImpact.textContent=`${n}+ people helped`}
function calculateLoan(){const e=parseInt(domElements.donationInput.value),t=10*e,n=Math.floor(e/200);domElements.calculateBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i> Calculating...';setTimeout((()=>{domElements.loanAccess.textContent=formatCurrency(t)+' KSH',domElements.communityImpact.textContent=`${n}+ people helped`,domElements.calculateBtn.innerHTML='<i class="fas fa-check"></i> Calculation Complete!';setTimeout((()=>{domElements.calculateBtn.innerHTML='<i class="fas fa-calculator"></i> Calculate Your Loan'}),2e3)}),1e3)}
function animateCalculatorResults(){document.querySelectorAll('.result-value').forEach((e=>{e.style.transform='scale(1.1)';setTimeout((()=>{e.style.transform='scale(1)'}),300)}))}
function initTestimonialSlider(){console.log('Initializing testimonial slider...');const e=document.querySelectorAll('.testimonial');let t=0,n=e.length;function o(e){e.forEach((e=>e.classList.remove('active'))),t=e,e[t].classList.add('active')}
function i(){t--,t<0&&(t=n-1),o(t),c()}function l(){t++,t>=n&&(t=0),o(t),c()}domElements.prevTestimonialBtn.addEventListener('click',i);domElements.nextTestimonialBtn.addEventListener('click',l);function s(){appState.testimonialAutoPlay=setInterval((()=>{t++,t>=n&&(t=0),o(t)}),8e3)}function c(){clearInterval(appState.testimonialAutoPlay),s()}s();console.log(`Testimonial slider initialized with ${n} testimonials`)}
function initDynamicContent(){console.log('Initializing dynamic content system...');loadSectionTemplates();window.addEventListener('load',(()=>{const e=window.location.hash.substring(1);e&&'home'!==e&&loadSection(e)}))}
function loadSectionTemplates(){appState.sections={about:getAboutSection(),products:getProductsSection(),quickloans:getQuickLoansSection(),businessloans:getBusinessLoansSection(),'donate-access':getDonateAccessSection(),borrow:getBorrowSection(),donate:getDonateSection(),contact:getContactSection(),careers:getCareersSection(),faqs:getFaqsSection()}}
function loadSection(e){console.log(`Loading section: ${e}`);window.history.pushState({},'',`#${e}`);appState.currentSection=e;document.querySelectorAll('.section').forEach((e=>e.classList.remove('active')));if('home'===e)return void(document.getElementById('home-section').classList.add('active'),domElements.dynamicContent.innerHTML='',window.scrollTo({top:0,behavior:'smooth'}));const t=appState.sections[e];if(t){domElements.dynamicContent.innerHTML=t,domElements.dynamicContent.style.animation='fadeIn 0.6s ease-out',initializeSection(e),setTimeout((()=>{domElements.dynamicContent.scrollIntoView({behavior:'smooth'})}),100)}else domElements.dynamicContent.innerHTML=`<div class="dynamic-section" style="text-align: center; padding: 100px 20px;"><h2>Section Not Found</h2><p>The requested section is not available.</p><a href="#home" class="cta-button" data-section="home">Return to Home</a></div>`}
function initializeSection(e){switch(e){case'faqs':initFAQs();break;case'contact':initContactForm();break;case'donate':initDonationForm()}}
function getAboutSection(){return`<section class="dynamic-section fade-in" id="about-section"><div class="container"><h1 class="section-title">About Microokoa Guaranty Capital</h1><div class="about-content"><div class="about-hero"><div class="about-text"><h2>Our Mission</h2><p>To empower communities through innovative, donation-based financing that creates sustainable economic growth and financial inclusion for all.</p><h2>Our Vision</h2><p>A world where every individual has access to financial resources to grow their business and improve their livelihood, regardless of their banking status.</p><h2>Our Model</h2><p>We operate on a unique community-powered financing model where donations from members create a lending pool that enables 10x loan access for contributors.</p></div><div class="about-stats"><div class="stat-card"><h3>10x</h3><p>Loan Multiplier</p></div><div class="stat-card"><h3>2 Hours</h3><p>Average Processing</p></div><div class="stat-card"><h3>100%</h3><p>Community Reinvestment</p></div><div class="stat-card"><h3>0%</h3><p>Public Deposits</p></div></div></div><div class="values-section"><h2>Our Core Values</h2><div class="values-grid"><div class="value-card"><i class="fas fa-users"></i><h3>Community First</h3><p>All profits are reinvested locally to support community development.</p></div><div class="value-card"><i class="fas fa-shield-alt"></i><h3>Transparency</h3><p>Clear terms, no hidden fees, complete operational transparency.</p></div><div class="value-card"><i class="fas fa-handshake"></i><h3>Trust</h3><p>Built on mutual trust between community members.</p></div><div class="value-card"><i class="fas fa-rocket"></i><h3>Innovation</h3><p>Continuously improving our donation-based model.</p></div></div></div><div class="team-section"><h2>Our Commitment</h2><div class="commitment-box"><p><strong>We are a non-deposit-taking institution:</strong> We do NOT accept savings or deposits from the public. Our funds come solely from community donations that are then multiplied into loans.</p><p><strong>Regulatory Compliance:</strong> We operate within the guidelines set by relevant financial authorities in Kenya.</p><p><strong>Customer Protection:</strong> Your data and transactions are secured with bank-level encryption.</p></div></div></div></div></section>`}
function getProductsSection(){return`<section class="dynamic-section fade-in" id="products-section"><div class="container"><h1 class="section-title">Our Loan Products</h1><p class="section-subtitle">Tailored financing solutions for your needs</p><div class="products-grid"><div class="product-card"><div class="product-header"><h3>QuickLoans</h3><p>Fast, small loans for immediate needs</p></div><div class="product-body"><div class="product-amount">Up to Kshs 30,000</div><ul class="product-features"><li>24-hour approval process</li><li>Emergency fund access</li><li>Flexible repayment options</li><li>Minimum donation: Kshs 200</li><li>10x loan multiplier</li></ul><div class="product-cta"><a href="#quickloans" class="cta-button" data-section="quickloans">Learn More</a></div></div></div><div class="product-card"><div class="product-header"><h3>BusinessLoans</h3><p>Capital for business expansion</p></div><div class="product-body"><div class="product-amount">Up to Kshs 50,000</div><ul class="product-features"><li>3–6 month repayment terms</li><li>Business training included</li><li>Inventory & equipment financing</li><li>Minimum donation: Kshs 500</li><li>Growth-focused support</li></ul><div class="product-cta"><a href="#businessloans" class="cta-button" data-section="businessloans">Learn More</a></div></div></div><div class="product-card"><div class="product-header"><h3>Donate & Access</h3><p>Community participation program</p></div><div class="product-body"><div class="product-amount">10x Multiplier</div><ul class="product-features"><li>Minimum donation: Kshs 200</li><li>Unlock borrowing potential</li><li>Build community capital</li><li>Help others while helping yourself</li><li>Transparent impact tracking</li></ul><div class="product-cta"><a href="#donate-access" class="cta-button" data-section="donate-access">Learn More</a></div></div></div></div><div class="comparison-section"><h2>Product Comparison</h2><div class="comparison-table"><table><thead><tr><th>Feature</th><th>QuickLoans</th><th>BusinessLoans</th><th>Donate & Access</th></tr></thead><tbody><tr><td>Maximum Amount</td><td>Kshs 30,000</td><td>Kshs 50,000</td><td>10x Donation</td></tr><tr><td>Processing Time</td><td>24 hours</td><td>48 hours</td><td>2 hours</td></tr><tr><td>Minimum Donation</td><td>Kshs 200</td><td>Kshs 500</td><td>Kshs 200</td></tr><tr><td>Repayment Period</td><td>1-3 months</td><td>3-6 months</td><td>Flexible</td></tr><tr><td>Business Training</td><td>Basic</td><td>Comprehensive</td><td>Optional</td></tr></tbody></table></div></div></div></section>`}
function getQuickLoansSection(){return`<section class="dynamic-section fade-in" id="quickloans-section"><div class="container"><div class="product-detail-header"><h1 class="section-title">QuickLoans</h1><p class="section-subtitle">Fast access to emergency funds when you need them most</p></div><div class="product-detail-content"><div class="detail-left"><h2>What is QuickLoans?</h2><p>QuickLoans are designed for urgent financial needs that can't wait. Whether it's medical emergencies, school fees, or unexpected expenses, get the funds you need within 24 hours.</p><h3>Key Benefits:</h3><ul class="benefits-list"><li><i class="fas fa-bolt"></i> <strong>24-Hour Approval:</strong> Get approved and funded within one business day</li><li><i class="fas fa-mobile-alt"></i> <strong>Mobile Disbursement:</strong> Funds sent directly to your M-Pesa or Airtel Money</li><li><i class="fas fa-shield-alt"></i> <strong>No Collateral:</strong> No physical assets required as security</li><li><i class="fas fa-sync-alt"></i> <strong>Flexible Repayment:</strong> Choose repayment terms that work for you</li><li><i class="fas fa-chart-line"></i> <strong>Build Credit:</strong> Timely repayment improves your borrowing capacity</li></ul><div class="eligibility-box"><h3>Eligibility Requirements:</h3><ul><li>Kenyan citizen aged 18+</li><li>Active mobile money account (M-Pesa/Airtel Money)</li><li>Minimum donation of Kshs 200 to community fund</li><li>Valid national ID</li><li>Proof of income or business activity</li></ul></div></div><div class="detail-right"><div class="calculator-mini"><h3>Quick Loan Calculator</h3><div class="calculator-mini-content"><div class="input-group"><label>Desired Loan Amount (KSH)</label><input type="range" min="1000" max="30000" step="1000" value="10000" id="quickloan-slider"><div class="slider-value-mini"><span id="quickloan-value">10,000</span> KSH</div></div><div class="result-group"><div class="result-item-mini"><span>Required Donation:</span><span id="required-donation">1,000 KSH</span></div><div class="result-item-mini"><span>Estimated Repayment (3 months):</span><span id="estimated-repayment">11,000 KSH</span></div></div><button class="cta-button apply-now-btn" onclick="loadSection('donate')"><i class="fas fa-paper-plane"></i> Apply Now</button></div></div><div class="process-steps"><h3>Application Process</h3><ol><li>Make minimum donation (Kshs 200)</li><li>Complete online application</li><li>Upload required documents</li><li>Get approval within 24 hours</li><li>Receive funds via mobile money</li></ol></div></div></div><div class="testimonial-quick"><blockquote>"I needed emergency funds for my daughter's school fees. I donated Kshs 500 in the morning and by evening I had Kshs 5,000 in my M-Pesa. Microokoa saved the day!"<cite>- Jane Wanjiru, Nairobi</cite></blockquote></div></div></section>`}
function getBusinessLoansSection(){return`<section class="dynamic-section fade-in" id="businessloans-section"><div class="container"><div class="product-detail-header"><h1 class="section-title">BusinessLoans</h1><p class="section-subtitle">Fuel your business growth with capital for expansion and development</p></div><div class="product-detail-content"><div class="detail-left"><h2>Grow Your Enterprise</h2><p>BusinessLoans provide the capital you need to take your business to the next level. Whether it's purchasing inventory, upgrading equipment, or expanding operations, we're here to support your growth journey.</p><div class="use-cases"><h3>Common Use Cases:</h3><div class="use-case-grid"><div class="use-case"><i class="fas fa-boxes"></i><h4>Inventory Purchase</h4><p>Stock up on products for peak seasons</p></div><div class="use-case"><i class="fas fa-tools"></i><h4>Equipment Upgrade</h4><p>Modernize your tools and machinery</p></div><div class="use-case"><i class="fas fa-store"></i><h4>Business Expansion</h4><p>Open new locations or increase capacity</p></div><div class="use-case"><i class="fas fa-graduation-cap"></i><h4>Staff Training</h4><p>Invest in your team's skills development</p></div></div></div><div class="training-included"><h3><i class="fas fa-chalkboard-teacher"></i> Business Training Included</h3><p>All BusinessLoan recipients receive complimentary access to our business development workshops covering:</p><ul><li>Financial management and record keeping</li><li>Marketing and customer acquisition</li><li>Inventory management best practices</li><li>Digital tools for small businesses</li></ul></div></div><div class="detail-right"><div class="loan-options"><h3>Loan Packages</h3><div class="package-option"><h4>Starter Package</h4><div class="package-amount">Up to Kshs 20,000</div><ul><li>3-month repayment term</li><li>Basic business training</li><li>Weekly repayment option</li></ul><div class="required-donation">Min. Donation: Kshs 2,000</div></div><div class="package-option featured"><h4>Growth Package</h4><div class="package-amount">Up to Kshs 35,000</div><ul><li>4-month repayment term</li><li>Comprehensive training</li><li>Monthly repayment option</li><li>Business mentoring</li></ul><div class="required-donation">Min. Donation: Kshs 3,500</div></div><div class="package-option"><h4>Expansion Package</h4><div class="package-amount">Up to Kshs 50,000</div><ul><li>6-month repayment term</li><li>Advanced business training</li><li>Flexible repayment schedule</li><li>Priority support</li></ul><div class="required-donation">Min. Donation: Kshs 5,000</div></div></div><div class="success-metrics"><h3>Business Impact Metrics</h3><div class="metric"><div class="metric-value">87%</div><div class="metric-label">Report increased revenue</div></div><div class="metric"><div class="metric-value">64%</div><div class="metric-label">Hired additional staff</div></div><div class="metric"><div class="metric-value">92%</div><div class="metric-label">Would recommend to others</div></div></div></div></div><div class="cta-section"><h2>Ready to Grow Your Business?</h2><p>Take the first step toward business expansion today</p><div class="cta-buttons"><a href="#donate" class="cta-button" data-section="donate"><i class="fas fa-donate"></i> Start with Donation</a><a href="#contact" class="cta-button secondary" data-section="contact"><i class="fas fa-phone-alt"></i> Schedule Consultation</a></div></div></div></section>`}
function getDonateAccessSection(){return`<section class="dynamic-section fade-in" id="donate-access-section"><div class="container"><div class="product-detail-header"><h1 class="section-title">Donate & Access Program</h1><p class="section-subtitle">Participate in community funding and unlock your borrowing potential</p></div><div class="donate-access-content"><div class="explanation-box"><h2>How It Works</h2><p>The Donate & Access program is the foundation of our community-powered financing model. When you donate to the community fund, you're not just giving—you're investing in your own and others' financial futures.</p><div class="mechanism-diagram"><div class="diagram-step"><div class="step-number">1</div><h3>You Donate</h3><p>Contribute to the community fund (minimum Kshs 200)</p></div><div class="diagram-arrow">→</div><div class="diagram-step"><div class="step-number">2</div><h3>Funds Pool</h3><p>Your donation joins others to create a lending pool</p></div><div class="diagram-arrow">→</div><div class="diagram-step"><div class="step-number">3</div><h3>Loans Issued</h3><p>Community members access loans (10x their donation)</p></div><div class="diagram-arrow">→</div><div class="diagram-step"><div class="step-number">4</div><h3>Repayment & Growth</h3><p>Loans repaid, fund grows, more loans possible</p></div></div></div><div class="benefits-grid"><div class="benefit-card"><i class="fas fa-hand-holding-heart"></i><h3>Social Impact</h3><p>Your donation directly helps other community members access capital for their needs.</p></div><div class="benefit-card"><i class="fas fa-unlock-alt"></i><h3>Access Unlocked</h3><p>Donating gives you access to loans worth 10x your contribution amount.</p></div><div class="benefit-card"><i class="fas fa-chart-network"></i><h3>Community Growth</h3><p>As the community fund grows, larger loans become available to all members.</p></div><div class="benefit-card"><i class="fas fa-eye"></i><h3>Full Transparency</h3><p>Track exactly how your donation is used and who it helps in our monthly reports.</p></div></div><div class="impact-tracker"><h2>Community Impact Tracker</h2><div class="tracker-stats"><div class="tracker-stat"><div class="stat-value" id="total-donations">Kshs 2,450,800</div><div class="stat-label">Total Donations Received</div></div><div class="tracker-stat"><div class="stat-value" id="loans-issued">Kshs 24,508,000</div><div class="stat-label">Total Loans Issued (10x)</div></div><div class="tracker-stat"><div class="stat-value" id="people-helped">1,842</div><div class="stat-label">Community Members Helped</div></div><div class="tracker-stat"><div class="stat-value" id="repayment-rate">94.7%</div><div class="stat-label">Loan Repayment Rate</div></div></div><div class="donation-tiers"><h3>Donation Tiers & Benefits</h3><div class="tiers-grid"><div class="tier"><h4>Basic Tier</h4><div class="tier-amount">Kshs 200 - 999</div><ul><li>Access to QuickLoans</li><li>Community newsletter</li><li>Basic impact reports</li></ul></div><div class="tier featured"><h4>Community Tier</h4><div class="tier-amount">Kshs 1,000 - 4,999</div><ul><li>Access to BusinessLoans</li><li>Priority loan processing</li><li>Detailed impact reports</li><li>Community voting rights</li></ul></div><div class="tier"><h4>Partner Tier</h4><div class="tier-amount">Kshs 5,000+</div><ul><li>All loan products access</li><li>Exclusive community events</li><li>Personal account manager</li><li>Recognition in reports</li></ul></div></div></div></div><div class="transparency-section"><h2><i class="fas fa-search-dollar"></i> Complete Transparency</h2><p>We believe in radical transparency. Every month, we publish a detailed report showing:</p><div class="transparency-list"><div class="transparency-item"><i class="fas fa-file-invoice-dollar"></i><span>All donations received (anonymous)</span></div><div class="transparency-item"><i class="fas fa-hand-holding-usd"></i><span>All loans issued (anonymous)</span></div><div class="transparency-item"><i class="fas fa-chart-pie"></i><span>Fund allocation breakdown</span></div><div class="transparency-item"><i class="fas fa-user-check"></i><span>Repayment status updates</span></div><div class="transparency-item"><i class="fas fa-bullseye"></i><span>Community impact metrics</span></div></div></div></div><div class="get-started-box"><h2>Ready to Join the Community?</h2><p>Start with a donation of any amount (minimum Kshs 200) and begin your journey with community-powered financing.</p><a href="#donate" class="cta-button large" data-section="donate"><i class="fas fa-heart"></i> Make Your First Donation</a></div></div></section>`}
function getBorrowSection(){return`<section class="dynamic-section fade-in" id="borrow-section"><div class="container"><h1 class="section-title">Borrow from Microokoa</h1><p class="section-subtitle">Access loans tailored to your needs through our community-powered model</p><div class="borrow-options"><div class="option-card large"><div class="option-icon"><i class="fas fa-bolt"></i></div><div class="option-content"><h2>Need Funds Quickly?</h2><p>For emergencies and immediate financial needs</p><div class="option-highlights"><div class="highlight"><i class="fas fa-clock"></i><span>24-hour approval</span></div><div class="highlight"><i class="fas fa-mobile-alt"></i><span>Mobile disbursement</span></div><div class="highlight"><i class="fas fa-shield-alt"></i><span>No collateral needed</span></div></div><div class="option-cta"><a href="#quickloans" class="cta-button" data-section="quickloans">Apply for QuickLoan</a><a href="#donate" class="cta-button secondary" data-section="donate">Donate First</a></div></div></div><div class="option-card large"><div class="option-icon"><i class="fas fa-chart-line"></i></div><div class="option-content"><h2>Growing Your Business?</h2><p>Capital for expansion, inventory, and equipment</p><div class="option-highlights"><div class="highlight"><i class="fas fa-graduation-cap"></i><span>Business training included</span></div><div class="highlight"><i class="fas fa-calendar-alt"></i><span>3-6 month terms</span></div><div class="highlight"><i class="fas fa-handshake"></i><span>Mentorship support</span></div></div><div class="option-cta"><a href="#businessloans" class="cta-button" data-section="businessloans">Apply for BusinessLoan</a><a href="#contact" class="cta-button secondary" data-section="contact">Get Consultation</a></div></div></div></div><div class="borrow-process"><h2>How to Borrow</h2><div class="process-steps-detailed"><div class="process-step"><div class="step-number">1</div><h3>Make a Donation</h3><p>Start by donating to the community fund (minimum Kshs 200). This activates your borrowing eligibility.</p><a href="#donate" class="step-link" data-section="donate">Make Donation →</a></div><div class="process-step"><div class="step-number">2</div><h3>Choose Loan Product</h3><p>Select between QuickLoans for emergencies or BusinessLoans for growth.</p><a href="#products" class="step-link" data-section="products">Compare Products →</a></div><div class="process-step"><div class="step-number">3</div><h3>Complete Application</h3><p>Fill our simple online application with required details and documents.</p><a href="#contact" class="step-link" data-section="contact">Start Application →</a></div><div class="process-step"><div class="step-number">4</div><h3>Receive Funds</h3><p>Get approved and receive funds directly to your mobile money account.</p><a href="#faqs" class="step-link" data-section="faqs">Learn More →</a></div></div></div><div class="eligibility-checker"><h2>Check Your Eligibility</h2><div class="checker-form"><div class="form-group"><label>Have you made a donation to the community fund?</label><div class="radio-group"><label><input type="radio" name="donation" value="yes"> Yes</label><label><input type="radio" name="donation" value="no"> Not yet</label></div></div><div class="form-group"><label>Do you have an active M-Pesa or Airtel Money account?</label><div class="radio-group"><label><input type="radio" name="mobile-money" value="yes"> Yes</label><label><input type="radio" name="mobile-money" value="no"> No</label></div></div><div class="form-group"><label>Are you 18 years or older?</label><div class="radio-group"><label><input type="radio" name="age" value="yes"> Yes</label><label><input type="radio" name="age" value="no"> No</label></div></div><button class="cta-button" id="check-eligibility"><i class="fas fa-check-circle"></i> Check Eligibility</button><div id="eligibility-result" class="eligibility-result"></div></div></div></div></section>`}
function getDonateSection(){return`<section class="dynamic-section fade-in" id="donate-section"><div class="container"><h1 class="section-title">Donate to the Community Fund</h1><p class="section-subtitle">Your donation helps others and unlocks your borrowing potential</p><div class="donation-content"><div class="donation-left"><div class="impact-calculator"><h2>Calculate Your Impact</h2><div class="impact-input"><label>Donation Amount (KSH)</label><div class="amount-options"><button class="amount-option" data-amount="200">Kshs 200</button><button class="amount-option" data-amount="500">Kshs 500</button><button class="amount-option" data-amount="1000">Kshs 1,000</button><button class="amount-option" data-amount="2000">Kshs 2,000</button><button class="amount-option" data-amount="5000">Kshs 5,000</button></div><div class="custom-amount"><input type="number" id="custom-amount" min="200" max="50000" placeholder="Custom amount" value="2000"><span class="currency">KSH</span></div></div><div class="impact-results"><div class="impact-result"><div class="impact-icon"><i class="fas fa-hand-holding-usd"></i></div><div class="impact-text"><h4>Loan Access Unlocked</h4><p class="impact-value" id="unlocked-loan">Kshs 20,000</p></div></div><div class="impact-result"><div class="impact-icon"><i class="fas fa-users"></i></div><div class="impact-text"><h4>People Helped</h4><p class="impact-value" id="people-helped-count">10+</p></div></div><div class="impact-result"><div class="impact-icon"><i class="fas fa-chart-network"></i></div><div class="impact-text"><h4>Community Growth</h4><p class="impact-value" id="community-growth">Kshs 200,000+</p></div></div></div></div><div class="payment-methods"><h3>Payment Methods</h3><div class="method-options"><div class="method-option active"><i class="fas fa-mobile-alt"></i><span>M-Pesa</span></div><div class="method-option"><i class="fas fa-sim-card"></i><span>Airtel Money</span></div><div class="method-option"><i class="fas fa-credit-card"></i><span>Card Payment</span></div></div><div class="payment-instructions"><h4>To pay via M-Pesa:</h4><ol><li>Go to Lipa na M-Pesa</li><li>Select Pay Bill</li><li>Enter Business No: <strong>123456</strong></li><li>Enter Account No: <strong>DONATE</strong></li><li>Enter Amount</li><li>Enter your M-Pesa PIN</li><li>Confirm payment</li></ol></div></div></div><div class="donation-right"><div class="donation-form"><h2>Make Your Donation</h2><form id="donationForm"><div class="form-group"><label for="donor-name">Full Name *</label><input type="text" id="donor-name" required></div><div class="form-group"><label for="donor-phone">Phone Number *</label><input type="tel" id="donor-phone" required placeholder="07XX XXX XXX"></div><div class="form-group"><label for="donor-email">Email Address</label><input type="email" id="donor-email"></div><div class="form-group"><label for="donation-purpose">Purpose of Donation</label><select id="donation-purpose"><option value="general">General Community Fund</option><option value="quickloan">To Access QuickLoans</option><option value="businessloan">To Access BusinessLoans</option><option value="support">Just to Support Community</option></select></div><div class="form-group"><label>Receive Updates</label><div class="checkbox-group"><label><input type="checkbox" checked>Send me monthly impact reports</label><label><input type="checkbox" checked>Notify me about community events</label></div></div><div class="form-group"><div class="terms-agreement"><label><input type="checkbox" required>I agree to the <a href="#terms" onclick="loadSection('faqs')">Terms & Conditions</a></label></div></div><button type="submit" class="cta-button large"><i class="fas fa-heart"></i> Complete Donation</button></form><div class="security-notice"><i class="fas fa-lock"></i><span>Your donation is secure and protected</span></div></div><div class="donation-benefits"><h3>Benefits of Donating</h3><ul><li><i class="fas fa-check-circle"></i> Unlock 10x loan access</li><li><i class="fas fa-check-circle"></i> Join the community network</li><li><i class="fas fa-check-circle"></i> Receive impact reports</li><li><i class="fas fa-check-circle"></i> Priority loan processing</li><li><i class="fas fa-check-circle"></i> Community voting rights</li></ul></div></div></div><div class="donation-faq"><h3>Common Questions</h3><div class="faq-items"><div class="faq-item"><div class="faq-question">Is there a minimum donation amount?<i class="fas fa-chevron-down"></i></div><div class="faq-answer">Yes, the minimum donation is Kshs 200. This is to ensure administrative efficiency while keeping participation accessible.</div></div><div class="faq-item"><div class="faq-question">When will I be able to borrow after donating?<i class="fas fa-chevron-down"></i></div><div class="faq-answer">Immediately! Once your donation is confirmed, you can apply for loans right away. The 10x multiplier applies to your total donations.</div></div><div class="faq-item"><div class="faq-question">Can I donate multiple times?<i class="fas fa-chevron-down"></i></div><div class="faq-answer">Absolutely! You can donate as many times as you want. Each donation increases your total contribution and corresponding loan access.</div></div></div></div></div></section>`}
function getContactSection(){return`<section class="dynamic-section fade-in" id="contact-section"><div class="container"><h1 class="section-title">Contact Us</h1><p class="section-subtitle">Get in touch with our team for support, inquiries, or partnerships</p><div class="contact-content"><div class="contact-info-grid"><div class="contact-info-card"><div class="contact-icon"><i class="fas fa-phone-alt"></i></div><h3>Phone Support</h3><p>+254-710-340-896</p><p class="contact-hours">Mon-Fri: 8am-6pm EAT</p><a href="tel:+254710340896" class="contact-link">Call Now</a></div><div class="contact-info-card"><div class="contact-icon"><i class="fas fa-envelope"></i></div><h3>Email Us</h3><p>microokoaguarantycapital@gmail.com</p><p class="contact-hours">Response within 24 hours</p><a href="mailto:microokoaguarantycapital@gmail.com" class="contact-link">Send Email</a></div><div class="contact-info-card"><div class="contact-icon"><i class="fab fa-whatsapp"></i></div><h3>WhatsApp</h3><p>+254-710-340-896</p><p class="contact-hours">24/7 Chat Support</p><a href="https://wa.me/254710340896" target="_blank" class="contact-link">Start Chat</a></div><div class="contact-info-card"><div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div><h3>Visit Us</h3><p>Nairobi, Kenya</p><p class="contact-hours">By appointment only</p><a href="#contact-form" class="contact-link">Schedule Visit</a></div></div><div class="contact-form-section"><div class="form-container"><h2>Send Us a Message</h2><form id="contactForm"><div class="form-row"><div class="form-group"><label for="contact-name">Full Name *</label><input type="text" id="contact-name" required></div><div class="form-group"><label for="contact-phone">Phone Number *</label><input type="tel" id="contact-phone" required></div></div><div class="form-group"><label for="contact-email">Email Address *</label><input type="email" id="contact-email" required></div><div class="form-group"><label for="contact-subject">What are you interested in? *</label><select id="contact-subject" required><option value="">Select an option</option><option value="donation">Making a Donation</option><option value="quickloan">QuickLoan Application</option><option value="businessloan">BusinessLoan Application</option><option value="general">General Inquiry</option><option value="partnership">Partnership Opportunity</option><option value="support">Customer Support</option><option value="career">Career Opportunity</option></select></div><div class="form-group"><label for="contact-message">Message *</label><textarea id="contact-message" rows="5" required></textarea></div><div class="form-group"><div class="checkbox-group"><label><input type="checkbox" required>I agree to the privacy policy and terms of service</label></div></div><button type="submit" class="cta-button large"><i class="fas fa-paper-plane"></i> Send Message</button></form></div><div class="response-time"><h3><i class="fas fa-clock"></i> Typical Response Times</h3><ul><li><strong>Loan Applications:</strong> 24 hours</li><li><strong>Donation Inquiries:</strong> 2 hours</li><li><strong>General Questions:</strong> 6 hours</li><li><strong>Partnership Requests:</strong> 48 hours</li></ul></div></div><div class="social-contact"><h2>Connect With Us on Social Media</h2><div class="social-buttons"><a href="#" class="social-button twitter"><i class="fab fa-twitter"></i><span>Twitter: @MicrookoaGuaCap</span></a><a href="#" class="social-button facebook"><i class="fab fa-facebook-f"></i><span>Facebook: Microokoa Guaranty Capital</span></a><a href="#" class="social-button youtube"><i class="fab fa-youtube"></i><span>YouTube: Microokoa Channel</span></a></div></div></div></div></section>`}
function getCareersSection(){return`<section class="dynamic-section fade-in" id="careers-section"><div class="container"><h1 class="section-title">Careers at Microokoa</h1><p class="section-subtitle">Join our mission to empower communities through innovative financing</p><div class="careers-intro"><div class="intro-content"><h2>Why Work With Us?</h2><p>At Microokoa Guaranty Capital, we're not just building a company—we're building a movement. We believe in financial inclusion, community empowerment, and innovative solutions that make a real difference in people's lives.</p><div class="culture-highlights"><div class="culture-item"><i class="fas fa-bullseye"></i><h4>Purpose-Driven Work</h4><p>Every role contributes directly to community development</p></div><div class="culture-item"><i class="fas fa-users"></i><h4>Collaborative Culture</h4><p>Work with passionate professionals who share your values</p></div><div class="culture-item"><i class="fas fa-chart-line"></i><h4>Growth Opportunities</h4><p>Continuous learning and career advancement</p></div><div class="culture-item"><i class="fas fa-balance-scale"></i><h4>Work-Life Balance</h4><p>Flexible arrangements and supportive environment</p></div></div></div></div><div class="job-listings"><h2>Current Openings</h2><div class="job-card"><div class="job-header"><h3>Community Relations Officer</h3><div class="job-meta"><span><i class="fas fa-map-marker-alt"></i> Nairobi</span><span><i class="fas fa-briefcase"></i> Full-time</span><span><i class="fas fa-clock"></i> Posted 2 days ago</span></div></div><div class="job-body"><h4>Role Overview:</h4><p>Build and maintain relationships with community members, educate about our donation-based model, and facilitate loan applications.</p><h4>Responsibilities:</h4><ul><li>Engage with community members and explain our model</li><li>Assist with donation and loan applications</li><li>Organize community workshops and training sessions</li><li>Collect feedback and report on community needs</li><li>Build partnerships with local organizations</li></ul><h4>Requirements:</h4><ul><li>Degree in Community Development, Social Work, or related field</li><li>2+ years experience in community engagement</li><li>Excellent communication skills in Swahili and English</li><li>Understanding of microfinance or community banking</li><li>Passion for financial inclusion and community development</li></ul><div class="job-cta"><a href="#contact" class="cta-button" data-section="contact"><i class="fas fa-paper-plane"></i> Apply Now</a></div></div></div><div class="job-card"><div class="job-header"><h3>Digital Marketing Specialist</h3><div class="job-meta"><span><i class="fas fa-map-marker-alt"></i> Remote</span><span><i class="fas fa-briefcase"></i> Full-time</span><span><i class="fas fa-clock"></i> Posted 5 days ago</span></div></div><div class="job-body"><h4>Role Overview:</h4><p>Drive our digital presence and customer acquisition through strategic marketing campaigns and content creation.</p><h4>Responsibilities:</h4><ul><li>Develop and execute digital marketing strategies</li><li>Manage social media platforms and content calendar</li><li>Create engaging content about our community impact</li><li>Analyze campaign performance and optimize results</li><li>Collaborate with community team for local outreach</li></ul><h4>Requirements:</h4><ul><li>3+ years experience in digital marketing</li><li>Proven track record with social media campaigns</li><li>Experience with analytics tools (Google Analytics, etc.)</li><li>Excellent writing and communication skills</li><li>Understanding of the Kenyan digital landscape</li></ul><div class="job-cta"><a href="#contact" class="cta-button" data-section="contact"><i class="fas fa-paper-plane"></i> Apply Now</a></div></div></div><div class="job-card"><div class="job-header"><h3>Loan Processing Officer</h3><div class="job-meta"><span><i class="fas fa-map-marker-alt"></i> Nairobi</span><span><i class="fas fa-briefcase"></i> Full-time</span><span><i class="fas fa-clock"></i> Posted 1 week ago</span></div></div><div class="job-body"><h4>Role Overview:</h4><p>Process loan applications efficiently while ensuring compliance and excellent customer service.</p><h4>Responsibilities:</h4><ul><li>Review and process loan applications</li><li>Verify applicant information and documents</li><li>Coordinate with mobile money partners for disbursements</li><li>Maintain accurate records and reports</li><li>Provide updates to applicants throughout the process</li></ul><h4>Requirements:</h4><ul><li>Degree in Finance, Business, or related field</li><li>2+ years experience in loan processing or microfinance</li><li>Attention to detail and analytical skills</li><li>Knowledge of regulatory requirements</li><li>Excellent organizational and communication skills</li></ul><div class="job-cta"><a href="#contact" class="cta-button" data-section="contact"><i class="fas fa-paper-plane"></i> Apply Now</a></div></div></div></div><div class="application-process"><h2>Our Hiring Process</h2><div class="process-steps-career"><div class="process-step-career"><div class="step-number-career">1</div><h3>Application Review</h3><p>We review all applications within 5 business days</p></div><div class="process-step-career"><div class="step-number-career">2</div><h3>Initial Interview</h3><p>30-minute video call with hiring manager</p></div><div class="process-step-career"><div class="step-number-career">3</div><h3>Skills Assessment</h3><p>Practical task related to the role</p></div><div class="process-step-career"><div class="step-number-career">4</div><h3>Final Interview</h3><p>Meeting with team members and leadership</p></div><div class="process-step-career"><div class="step-number-career">5</div><h3>Offer & Onboarding</h3><p>Welcome to the Microokoa family!</p></div></div></div><div class="general-application"><h2>Don't See Your Dream Role?</h2><p>We're always looking for talented individuals who share our mission. Send us your CV and tell us how you can contribute to our team.</p><a href="#contact" class="cta-button secondary" data-section="contact"><i class="fas fa-upload"></i> Submit General Application</a></div></div></section>`}
function getFaqsSection(){return`<section class="dynamic-section fade-in" id="faqs-section"><div class="container"><h1 class="section-title">Frequently Asked Questions</h1><p class="section-subtitle">Find answers to common questions about our donation-based financing model</p><div class="faq-categories"><div class="category-tabs"><button class="category-tab active" data-category="general">General Questions</button><button class="category-tab" data-category="donations">Donations</button><button class="category-tab" data-category="loans">Loans</button><button class="category-tab" data-category="security">Security & Trust</button></div><div class="faq-category-content"><div class="faq-category active" id="general-category"><div class="faq-item expanded"><div class="faq-question">What is Microokoa Guaranty Capital?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>Microokoa Guaranty Capital is a community development financial institution (CDFI) that operates on a unique donation-based financing model. We enable community members to donate to a shared fund and then access loans worth 10x their donation amount. We are a non-deposit-taking institution focused on financial inclusion.</p></div></div><div class="faq-item"><div class="faq-question">How does the donation-based model work?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>Our model is simple:</p><ol><li>You donate any amount (minimum Kshs 200) to the community fund</li><li>Your donation pools with others to create a lending capital</li><li>You can then access loans worth 10x your total donations</li><li>Loan repayments go back into the fund, allowing more loans</li><li>The cycle continues, helping more community members</li></ol></div></div><div class="faq-item"><div class="faq-question">Are you a bank or SACCO?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>No, we are not a bank, SACCO, or deposit-taking institution. We do NOT accept savings or deposits from the public. We operate as a community development financial institution with a unique donation-based model that focuses on peer-to-peer community financing rather than traditional banking.</p></div></div></div><div class="faq-category" id="donations-category"><div class="faq-item"><div class="faq-question">What is the minimum donation amount?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>The minimum donation is Kshs 200. This low threshold ensures that everyone can participate in the community fund, regardless of their financial situation. You can donate more to increase your loan access potential.</p></div></div><div class="faq-item"><div class="faq-question">How do I make a donation?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>You can donate through multiple channels:</p><ol><li><strong>M-Pesa:</strong> Go to Lipa na M-Pesa → Pay Bill → Business No: 123456 → Account: DONATE</li><li><strong>Airtel Money:</strong> Send money to Till No: 987654</li><li><strong>Online:</strong> Use our secure donation portal on this website</li><li><strong>Card Payment:</strong> Visa/Mastercard payments accepted online</li></ol><p>After donating, make sure to register your details so we can link the donation to your account.</p></div></div><div class="faq-item"><div class="faq-question">Can I get my donation back?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>Donations to the community fund are not refundable as they become part of the collective lending pool. However, your donation gives you access to loans worth 10x the amount, effectively multiplying your contribution's value. Think of it as converting your donation into loan access credit rather than a traditional deposit.</p></div></div></div><div class="faq-category" id="loans-category"><div class="faq-item"><div class="faq-question">How much can I borrow?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>You can borrow up to 10x your total donations. For example:</p><ul><li>Donate Kshs 200 → Borrow up to Kshs 2,000</li><li>Donate Kshs 1,000 → Borrow up to Kshs 10,000</li><li>Donate Kshs 5,000 → Borrow up to Kshs 50,000</li></ul><p>There are product-specific maximums: QuickLoans up to Kshs 30,000 and BusinessLoans up to Kshs 50,000.</p></div></div><div class="faq-item"><div class="faq-question">How long does loan processing take?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>Processing times vary by product:</p><ul><li><strong>QuickLoans:</strong> 24 hours or less for emergencies</li><li><strong>BusinessLoans:</strong> 48 hours for standard processing</li><li><strong>Donation verification:</strong> 2 hours after payment confirmation</li></ul><p>We pride ourselves on fast processing to meet urgent financial needs.</p></div></div><div class="faq-item"><div class="faq-question">What are the interest rates?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>We don't charge traditional interest rates. Instead, we have a small service fee that covers operational costs and contributes to the community fund's growth. The fee structure is:</p><ul><li><strong>QuickLoans:</strong> 10% fee added to principal</li><li><strong>BusinessLoans:</strong> 15% fee added to principal</li></ul><p>For example, a Kshs 10,000 QuickLoan would require repayment of Kshs 11,000 over the agreed term. All fees are transparently displayed before you accept any loan.</p></div></div></div><div class="faq-category" id="security-category"><div class="faq-item"><div class="faq-question">Is my money safe with Microokoa?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>Yes, we implement multiple security measures:</p><ul><li><strong>SSL Encryption:</strong> All online transactions are encrypted</li><li><strong>Secure Partnerships:</strong> We work with licensed mobile money providers</li><li><strong>Regular Audits:</strong> Independent financial audits conducted quarterly</li><li><strong>Transparent Reporting:</strong> Monthly public reports on fund status</li><li><strong>Regulatory Compliance:</strong> We operate within all applicable regulations</li></ul><p>However, please remember we are NOT a deposit-taking institution. Your donation becomes part of the community lending pool.</p></div></div><div class="faq-item"><div class="faq-question">Do you accept savings from the public?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p><strong>NO.</strong> We do NOT accept savings or deposits from the public. We are not licensed as a deposit-taking institution. The only funds we receive are donations to the community fund, which are then used to provide loans to community members. This is a crucial distinction that sets us apart from banks and SACCOs.</p></div></div><div class="faq-item"><div class="faq-question">What happens if I can't repay my loan?<i class="fas fa-chevron-down"></i></div><div class="faq-answer"><p>We understand that circumstances can change. If you're facing difficulties:</p><ol><li><strong>Contact us immediately:</strong> Don't wait until you default</li><li><strong>We offer flexibility:</strong> We can restructure your repayment plan</li><li><strong>Community support:</strong> We connect you with community resources</li><li><strong>Grace periods:</strong> We offer short grace periods for genuine cases</li></ol><p>Our approach is supportive rather than punitive. However, consistent default affects your future loan access and the community fund's health.</p></div></div></div></div></div><div class="still-have-questions"><h2>Still Have Questions?</h2><p>Can't find what you're looking for? Our team is here to help.</p><div class="contact-options"><a href="#contact" class="cta-button" data-section="contact"><i class="fas fa-envelope"></i> Contact Support</a><a href="tel:+254710340896" class="cta-button secondary"><i class="fas fa-phone-alt"></i> Call Now: +254-710-340-896</a></div></div></div></section>`}
function formatCurrency(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}
function initFAQs(){const e=document.querySelectorAll('.faq-question'),t=document.querySelectorAll('.category-tab');e.forEach((e=>{e.addEventListener('click',(()=>{const t=e.parentElement,n=t.querySelector('.faq-answer'),o=t.closest('.faq-category').querySelectorAll('.faq-item');o.forEach((e=>{e!==t&&(e.classList.remove('expanded'),e.querySelector('.faq-answer').classList.remove('active'))})),t.classList.toggle('expanded'),n.classList.toggle('active'))}))});t.forEach((e=>{e.addEventListener('click',(()=>{const n=e.getAttribute('data-category');t.forEach((e=>e.classList.remove('active'))),e.classList.add('active');const o=document.querySelectorAll('.faq-category');o.forEach((e=>{e.classList.remove('active'),e.id===`${n}-category`&&e.classList.add('active')}))}))}))}
function initContactForm(){const e=document.getElementById('contactForm');e&&e.addEventListener('submit',(function(t){t.preventDefault();const n={name:document.getElementById('contact-name').value,phone:document.getElementById('contact-phone').value,email:document.getElementById('contact-email').value,subject:document.getElementById('contact-subject').value,message:document.getElementById('contact-message').value},o=e.querySelector('button[type="submit"]'),c=o.innerHTML;o.innerHTML='<i class="fas fa-spinner fa-spin"></i> Sending...',o.disabled=!0;setTimeout((()=>{console.log('Form submitted:',n),o.innerHTML='<i class="fas fa-check"></i> Message Sent!',o.style.backgroundColor='#28a745';setTimeout((()=>{e.reset(),o.innerHTML=c,o.style.backgroundColor='',o.disabled=!1,showNotification('Message sent successfully! We\\'ll respond within 24 hours.','success')}),2e3)}),1500)}))}
function initDonationForm(){const e=document.getElementById('donationForm');if(e){e.addEventListener('submit',(function(t){t.preventDefault();const n=document.getElementById('custom-amount'),o=n?parseInt(n.value):2e3,c=e.querySelector('button[type="submit"]'),l=c.innerHTML;c.innerHTML='<i class="fas fa-spinner fa-spin"></i> Processing Donation...',c.disabled=!0;setTimeout((()=>{console.log(`Processing donation of Kshs ${o}`),c.innerHTML='<i class="fas fa-check"></i> Donation Complete!',c.style.backgroundColor='#28a745',showNotification(`Thank you! Your donation of Kshs ${formatCurrency(o)} has been received. You now have access to loans up to Kshs ${formatCurrency(10*o)}.`,'success');setTimeout((()=>{e.reset(),c.innerHTML=l,c.style.backgroundColor='',c.disabled=!1}),3e3)}),2e3)}));const t=document.querySelectorAll('.amount-option'),n=document.getElementById('custom-amount');t.forEach((e=>{e.addEventListener('click',(function(){const t=parseInt(this.getAttribute('data-amount'));n&&(n.value=t,updateDonationImpact(t));t.forEach((e=>e.classList.remove('active'))),this.classList.add('active')}))})),n&&n.addEventListener('input',(function(){const e=parseInt(this.value)||200;updateDonationImpact(e),t.forEach((e=>e.classList.remove('active')))}));const o=document.querySelectorAll('.method-option');o.forEach((e=>{e.addEventListener('click',(function(){o.forEach((e=>e.classList.remove('active'))),this.classList.add('active')}))})),updateDonationImpact(2e3)}}
function updateDonationImpact(e){const t=10*e,n=Math.floor(e/200),o=100*e,c=document.getElementById('unlocked-loan'),l=document.getElementById('people-helped-count'),s=document.getElementById('community-growth');c&&(c.textContent=`Kshs ${formatCurrency(t)}`),l&&(l.textContent=`${n}+`),s&&(s.textContent=`Kshs ${formatCurrency(o)}+`)}
function showNotification(e,t='info'){const n=document.querySelector('.notification');n&&n.remove();const o=document.createElement('div');o.className=`notification ${t}`,o.innerHTML=`<div class="notification-content"><i class="fas fa-${'success'===t?'check-circle':'info-circle'}"></i><span>${e}</span></div><button class="notification-close"><i class="fas fa-times"></i></button>`,document.body.appendChild(o);setTimeout((()=>{o.classList.add('show')}),10);setTimeout((()=>{o.classList.remove('show');setTimeout((()=>{o.parentNode&&o.parentNode.removeChild(o)}),300)}),5e3);const c=o.querySelector('.notification-close');c.addEventListener('click',(()=>{o.classList.remove('show');setTimeout((()=>{o.parentNode&&o.parentNode.removeChild(o)}),300)}))}
function initEventListeners(){window.addEventListener('resize',handleResize);window.addEventListener('scroll',handleScroll);window.addEventListener('popstate',handlePopState);const e=document.getElementById('check-eligibility');e&&e.addEventListener('click',checkEligibility);const t=document.getElementById('quickloan-slider');t&&t.addEventListener('input',(function(){const e=parseInt(this.value),t=document.getElementById('quickloan-value'),n=document.getElementById('required-donation'),o=document.getElementById('estimated-repayment');t&&(t.textContent=formatCurrency(e)),n&&(n.textContent=formatCurrency(e/10)+' KSH'),o&&(o.textContent=formatCurrency(Math.round(1.1*e))+' KSH')}))}
function handleResize(){window.innerWidth<=992?(domElements.header.style.height='70px',domElements.heroSlider.style.marginTop='70px'):(domElements.header.style.height='100px',domElements.heroSlider.style.marginTop='100px');window.innerWidth>992&&domElements.mainNav.classList.contains('active')&&closeMobileMenu()}
function handleScroll(){const e=window.scrollY;e>50?domElements.header.style.boxShadow='0 4px 20px rgba(0,0,0,0.15)':domElements.header.style.boxShadow='0 2px 10px rgba(0,0,0,0.1)'}
function handlePopState(){const e=window.location.hash.substring(1)||'home';loadSection(e)}
function checkEligibility(){const e=document.querySelector('input[name="donation"]:checked'),t=document.querySelector('input[name="mobile-money"]:checked'),n=document.querySelector('input[name="age"]:checked'),o=document.getElementById('eligibility-result');if(!e||!t||!n)return void(o.innerHTML='<div class="result-error">Please answer all questions</div>');const c='yes'===e.value&&'yes'===t.value&&'yes'===n.value;c?o.innerHTML=`<div class="result-success"><i class="fas fa-check-circle"></i><div><h4>Congratulations! You're eligible.</h4><p>You can proceed to apply for loans. Start by making a donation if you haven't already.</p><div class="result-actions"><a href="#donate" class="cta-button small" data-section="donate">Make Donation</a><a href="#products" class="cta-button small secondary" data-section="products">View Loan Products</a></div></div></div>`:(o.innerHTML='<div class="result-warning"><i class="fas fa-exclamation-triangle"></i><div><h4>Not eligible yet</h4><p>'+(e.value?'':'• Make a donation to the community fund first<br>')+(t.value?'':'• You need an active M-Pesa or Airtel Money account<br>')+(n.value?'':'• You must be 18 years or older<br>')+'</p><div class="result-actions"><a href="#faqs" class="cta-button small" data-section="faqs">Learn Requirements</a></div></div></div>')}
let pwaManager;function initPWA(){pwaManager=new class{constructor(){this.deferredPrompt=null,this.isStandalone=window.matchMedia('(display-mode: standalone)').matches,this.init()}
init(){console.log('PWA Manager Initializing...'),this.registerServiceWorker(),this.setupInstallPrompt(),this.setupNetworkStatus(),this.setupSplashScreen(),this.setupShareTarget()}
registerServiceWorker(){'serviceWorker'in navigator&&window.addEventListener('load',(()=>{navigator.serviceWorker.register('/sw.js').then((e=>{console.log('ServiceWorker registration successful:',e),e.addEventListener('updatefound',(()=>{const t=e.installing;console.log('New service worker found:',t),t.addEventListener('statechange',(()=>{'installed'===t.state&&navigator.serviceWorker.controller&&this.showUpdatePrompt()}))}))})).catch((e=>{console.log('ServiceWorker registration failed:',e)}))}))}
setupInstallPrompt(){window.addEventListener('beforeinstallprompt',(e=>{console.log('beforeinstallprompt event fired'),e.preventDefault(),this.deferredPrompt=e,this.showInstallPrompt()})),window.addEventListener('appinstalled',(()=>{console.log('PWA installed successfully'),this.deferredPrompt=null,this.hideInstallPrompt(),this.showNotification('Microokoa app installed successfully!','success')})),this.isStandalone&&(console.log('App is running in standalone mode'),this.hideInstallPrompt())}
setupNetworkStatus(){window.addEventListener('online',(()=>{console.log('App is online'),this.hideOfflineBanner(),this.showNotification('You are back online','success')})),window.addEventListener('offline',(()=>{console.log('App is offline'),this.showOfflineBanner(),this.showNotification('You are offline. Some features may not work.','warning')})),navigator.onLine||this.showOfflineBanner()}
setupSplashScreen(){setTimeout((()=>{const e=document.getElementById('splash-screen');e&&(e.classList.add('hide'),setTimeout((()=>{e.style.display='none'}),300))}),2e3)}
setupShareTarget(){window.location.search.includes('share-target')&&this.showShareTarget()}
showInstallPrompt(){if(!document.getElementById('pwa-install-prompt')){const e=document.createElement('div');e.className='pwa-install-prompt',e.id='pwa-install-prompt',e.innerHTML='<div class="prompt-content"><h4>Install Microokoa App</h4><p>Get faster access to loans and donations. Install our app for the best experience.</p></div><div class="pwa-install-buttons"><button class="pwa-install-btn" id="install-pwa-btn">Install</button><button class="pwa-install-btn pwa-dismiss-btn" id="dismiss-install-btn">Not Now</button></div>',document.body.appendChild(e),document.getElementById('install-pwa-btn').addEventListener('click',(()=>{this.installPWA()})),document.getElementById('dismiss-install-btn').addEventListener('click',(()=>{this.hideInstallPrompt()}))}const e=document.getElementById('pwa-install-prompt');e.classList.add('show'),setTimeout((()=>{e.classList.contains('show')&&this.hideInstallPrompt()}),1e4)}
hideInstallPrompt(){const e=document.getElementById('pwa-install-prompt');e&&e.classList.remove('show');const t=document.getElementById('install-app-btn');t&&t.classList.remove('show')}
installPWA(){if(this.deferredPrompt){this.deferredPrompt.prompt();this.deferredPrompt.userChoice.then((e=>{'accepted'===e.outcome?console.log('User accepted the install prompt'):console.log('User dismissed the install prompt'),this.deferredPrompt=null}))}this.hideInstallPrompt()}
showOfflineBanner(){if(!document.getElementById('offline-banner')){const e=document.createElement('div');e.className='offline-banner',e.id='offline-banner',e.innerHTML='<span>You are currently offline. Some features may not be available.</span>',document.body.insertAdjacentHTML('afterbegin',e.outerHTML)}const e=document.getElementById('offline-banner');e.classList.add('show')}
hideOfflineBanner(){const e=document.getElementById('offline-banner');e&&e.classList.remove('show')}
showUpdatePrompt(){confirm('A new version of Microokoa is available. Would you like to update now?')&&window.location.reload()}
showShareTarget(){const e=document.createElement('div');e.className='share-target show',e.id='share-target',e.innerHTML='<div class="share-target-content"><h3 class="share-target-title">Share with Microokoa</h3><form class="share-target-form" id="share-target-form"><div class="form-group"><label for="share-title">Title</label><input type="text" id="share-title" name="title"></div><div class="form-group"><label for="share-text">Message</label><textarea id="share-text" name="text" rows="4"></textarea></div><div class="form-group"><label for="share-url">URL</label><input type="url" id="share-url" name="url"></div><div class="form-buttons"><button type="submit" class="cta-button">Share</button><button type="button" class="cta-button secondary" id="cancel-share">Cancel</button></div></form></div>',document.body.appendChild(e);const t=new URLSearchParams(window.location.search);document.getElementById('share-title').value=t.get('title')||'',document.getElementById('share-text').value=t.get('text')||'',document.getElementById('share-url').value=t.get('url')||'',document.getElementById('share-target-form').addEventListener('submit',(e=>{e.preventDefault(),this.handleShareSubmit()})),document.getElementById('cancel-share').addEventListener('click',(()=>{this.hideShareTarget()}))}
hideShareTarget(){const e=document.getElementById('share-target');e&&(e.classList.remove('show'),setTimeout((()=>{e.remove(),window.history.replaceState({},document.title,window.location.pathname)}),300))}
handleShareSubmit(){const e=document.getElementById('share-title').value,t=document.getElementById('share-text').value,n=document.getElementById('share-url').value;console.log('Sharing content:',{title:e,text:t,url:n}),this.showNotification('Content shared successfully!','success'),this.hideShareTarget(),n.includes('donate')?loadSection('donate'):n.includes('loan')&&loadSection('products')}
requestNotificationPermission(){'Notification'in window&&'default'===Notification.permission&&Notification.requestPermission().then((e=>{console.log('Notification permission:',e),'granted'===e&&this.showNotification("Notifications enabled! You'll get updates about your loans and donations.",'success')}))}
syncBackgroundData(){'serviceWorker'in navigator&&'sync'in navigator.serviceWorker&&navigator.serviceWorker.ready.then((e=>{e.sync.register('donation-sync').then((()=>{console.log('Background sync registered')})).catch((e=>{console.log('Background sync registration failed:',e)}))}))}
checkForUpdate(){'serviceWorker'in navigator&&navigator.serviceWorker.ready.then((e=>{e.update()}))}
getAppUsageStats(){'getInstalledRelatedApps'in navigator&&navigator.getInstalledRelatedApps().then((e=>{console.log('Installed related apps:',e)}))}};const e=document.querySelector('.header-cta');if(e&&!pwaManager.isStandalone){const t=document.createElement('button');t.className='install-app-btn',t.id='install-app-btn',t.innerHTML='<i class="fas fa-download"></i> Install App',e.appendChild(t),document.getElementById('install-app-btn').addEventListener('click',(()=>{pwaManager.installPWA()})),pwaManager.deferredPrompt&&document.getElementById('install-app-btn').classList.add('show')}const t=document.createElement('div');t.className='splash-screen',t.id='splash-screen',t.innerHTML='<img src="assets/logo.svg" alt="Microokoa" class="splash-logo"><div class="splash-text">Microokoa Guaranty Capital</div><div class="splash-loading"></div>',document.body.insertAdjacentHTML('afterbegin',t.outerHTML)}
document.addEventListener('DOMContentLoaded',initApp);